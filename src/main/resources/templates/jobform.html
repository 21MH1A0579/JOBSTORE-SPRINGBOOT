<!-- <!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Job Registration Form</title>
  <style>
  
   body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f0f0f0;
  color: #333;
  line-height: 1.6;
}

h1 {
  text-align: center;
  color: #444;
  margin-top: 20px;
  font-size: 1.8em;
  color: #007bff; /* Blue heading */
}

fieldset {
  margin: 20px auto;
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 4px;
  background-color: #fff;
  width: 90%;
  max-width: 800px;
  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
}

legend {
  font-weight: bold;
  font-size: 1.2em;
  color: #555;
  color: #007bff; /* Blue legend */
}

label {
  display: inline-block;
  margin-bottom: 5px;
  font-weight: bold;
  color: #666;
}

input[type="number"],
input[type="text"],
span {
  width: 100%;
  max-width: 400px;
  padding: 10px;
  margin: 5px 0 15px;
  border: 1px solid #ccc;
  border-radius: 5px;
  box-sizing: border-box;
  font-size: 1em;
  color: #333;
  border-color: #ccc; /* Light gray border */
}

input[type="number"]:focus,
input[type="text"]:focus {
  border-color: #007bff;
  outline: none;
  box-shadow: 0 0 3px rgba(0, 123, 255, 0.5);
}

#skills-input {
  width: calc(100% - 20px);
}

button {
  display: block;
  width: 100%;
  max-width: 200px;
  padding: 8px 20px;
  margin: 20px auto;
  background-color: #007bff;
  color: #fff;
  font-size: 1em;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}

button:hover {
  background-color: #0056b3;
}

#selected-skills {
  margin-top: 10px;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 8px;
  background-color: #f9f9f9;
}

.skill-item {
  display: inline-block;
  margin: 5px;
  padding: 5px 15px;
  background-color: #28a745; /* Green for selected skills */
  color: white;
  border-radius: 20px;
  font-size: 14px;
  position: relative;
  font-weight: bold;
}

.skill-item .remove-skill {
  position: absolute;
  top: 5px;
  right: 5px;
  background: red;
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  font-size: 14px;
}
  </style>
</head>
<body>
  <h1>Job Registration Form</h1>
  <form action="/jobs/jobapplied" method="post">
  Non-editable Job Details
 <fieldset>
    <legend>Job Details</legend>
    <p>
      <label>Job ID:</label>
      <input type="text" th:value="${job.id}" id="job_id" name="job_id" readonly />
    </p>
    <p>
      <label>Job Profile:</label>
      <input type="text" th:value="${job.profile}" id="job_profile" name="job_profile" readonly />
    </p>
    <p>
      <label>Job Description:</label>
      <textarea th:text="${job.description}" readonly></textarea>
    </p>
   <p>
    <label>Required Skills:</label>
            <ul>
              <li th:each="tech : ${job.techsList}" th:text="${tech}"></li> List of required skills
            </ul>
  </p>
    <p>
      <label>Experience (in years):</label>
      <span th:text="${job.experience}" id="jobexp" name="jobexp" readonly />
    </p>
  </fieldset>

  Registration Form
  <fieldset>
    <legend>Candidate Details</legend>
    
      <p>
        <label>CANDIDATE ID:</label>
        <input type="text" th:value="${user.id}" name="user_id" id="user_id" readonly />
      </p>
      <p>
        <label>CANDIDATE NAME:</label>
        <input type="text" th:value="${user.name}" name="user_name" id="user_name" readonly />
      </p>
      <p>
        <label>CANDIDATE EMAIL:</label>
        <input type="text" th:value="${user.email}" name="user_email" id="user_email" readonly />
      </p>
      <p>
        <label>CANDIDATE PHONE:</label>
        <input type="text" th:value="${user.phone}" name="user_phone" id="user_phone" readonly />
      </p>

      Qualification Details
      <p>
        <label for="x_percentage">X Percentage:</label>
        <input type="number" id="x_percentage" name="x_percent" min="1" max="100" required />
      </p>
      <p>
        <label for="xii_percentage">XII Percentage:</label>
        <input type="number" id="xii_percentage" name="xii_percent" min="1" max="100" required />
      </p>
      <p>
        <label for="ug_percentage">UG Percentage:</label>
        <input type="number" id="ug_percentage" name="ug_percent" min="1" max="100" required />
      </p>
      <p>
        <label for="experience">Experience (in years):</label>
        <input type="number" id="experience" name="exp" min="0" max="50" required />
      </p>

      Skills Selection
      <p>
        <label for="skills-input">Skills:</label>
        <input type="text" id="skills-input" list="skills-list" placeholder="Type to select a skill" />
        <datalist id="skills-list">
          <option value="java"></option>
          <option value="JEE"></option>
          <option value="Spring"></option>
          <option value="SpringBoot"></option>
          <option value="Microservices"></option>
          <option value="Threads"></option>
          <option value="AWS"></option>
          <option value="Azure"></option>
          <option value="DevOps"></option>
          <option value="Blockchain"></option>
          <option value="Android"></option>
          <option value="Data Science"></option>
          <option value="C"></option>
          <option value="C++"></option>
          <option value="Kubernetes"></option>
          <option value="Hadoop"></option>
          <option value="Big Data"></option>
          <option value="Python"></option>
          <option value="NumPy"></option>
          <option value="Pandas"></option>
          <option value="Matplotlib"></option>
          <option value="Libraries"></option>
          <option value="Design Patterns"></option>
          <option value="Cloud"></option>
        </datalist>
      </p>

      Hidden Fields to Store Skills and Score
      <input type="hidden" id="selected-skills-input" name="selected_skills" />
      <input type="hidden" id="final_score" name="final_score" />
      <input type="hidden" id="result" name="result" value="pending" />

      Display Selected Skills (Optional, if you want to show the selected skills dynamically)
      <div id="selected-skills"></div>

      <button type="submit">Register</button>
    </form>
  </fieldset>


  <script>
  const jobExperience = parseFloat(document.getElementById('jobexp')?.textContent.trim() || "0");
  const jobSkills = document.getElementById('techs').textContent.split(',').map(skill => skill.trim()) || [];
  console.log(jobSkills);
  const skillsInputField = document.getElementById('skills-input');
  const selectedSkillsContainer = document.getElementById('selected-skills');
  const submitButton = document.querySelector('button[type="submit"]');
  const score=document.getElementById('final_score');
  const selectedSkills = new Set();

  // Add skill to the list
// Add skill to the list
skillsInputField.addEventListener('change', () => {
  const skill = skillsInputField.value.trim();
  if (skill && !selectedSkills.has(skill)) {
    selectedSkills.add(skill);
    displaySelectedSkills();
    skillsInputField.value = ''; // Clear the input field
  }
});

// Display selected skills dynamically
function displaySelectedSkills() {
  selectedSkillsContainer.innerHTML = ''; // Clear existing skills
  const skillsArray = Array.from(selectedSkills); // Convert Set to Array
  document.getElementById('selected-skills-input').value = skillsArray.join(','); // Update hidden input

  skillsArray.forEach(skill => {
    const skillDiv = document.createElement('div');
    skillDiv.className = 'skill-item';
    skillDiv.textContent = skill;

    const removeButton = document.createElement('span');
    removeButton.className = 'remove-skill';
    removeButton.textContent = 'Ã—';
    removeButton.addEventListener('click', () => {
      selectedSkills.delete(skill); // Remove from the set
      displaySelectedSkills(); // Update display
    });

    skillDiv.appendChild(removeButton);
    selectedSkillsContainer.appendChild(skillDiv); // Append skill to container
  });
}




 
//Add validation and final score calculation on submit
 submitButton.addEventListener('click', (e) => {
   e.preventDefault(); // Prevent form from submitting by default

   // Validate experience
   const userExperience = parseFloat(document.getElementById('experience').value);
   if (userExperience < jobExperience) {
     alert(`Your experience (${userExperience} years) must be at least ${jobExperience} years.`);
     return; // Exit if experience is invalid
   }

   // Validate percentages
   const xPercent = parseFloat(document.getElementById('x_percentage').value);
   const xiiPercent = parseFloat(document.getElementById('xii_percentage').value);
   const ugPercent = parseFloat(document.getElementById('ug_percentage').value);

   if (
     xPercent > 100 || xiiPercent > 100 || ugPercent > 100 ||
     xPercent < 0 || xiiPercent < 0 || ugPercent < 0 ||
     isNaN(xPercent) || isNaN(xiiPercent) || isNaN(ugPercent)
   ) {
     alert('Please ensure percentages are between 0 and 100.');
     return; // Exit if percentages are invalid
   }

   // Check if all percentage fields are filled
   if (isNaN(xPercent) || isNaN(xiiPercent) || isNaN(ugPercent) || xPercent === '' || xiiPercent === '' || ugPercent === '') {
     alert('Please fill in all percentage fields.');
     return; // Exit if any of the fields are empty
   }

   // Calculate average percentage score
   const averagePercentageScore = ((xPercent + xiiPercent + ugPercent) / 3).toFixed(2);

   // Validate and calculate skills match score
   let matchedSkillsCount = 0;
   selectedSkills.forEach(skill => {
     if (jobSkills.includes(skill.toLowerCase().toString())) {
       matchedSkillsCount++;
     }
   });
   const skillsMatchScore = ((matchedSkillsCount / jobSkills.length) * 100).toFixed(2);

   // Calculate final score by averaging percentage and skills scores
   const finalScore = ((parseFloat(averagePercentageScore) + parseFloat(skillsMatchScore)) / 2).toFixed(2);

   // Display the final scores in an alert
   alert(`
     Validation successful!
     - Average Percentage Score: ${averagePercentageScore}%
     - Skills Match Score: ${skillsMatchScore}%
     - Final Combined Score: ${finalScore}%
   `);

   // Store the final score in a hidden input field
   /* const scoreInput = document.createElement('input');
   scoreInput.type = 'hidden';
   scoreInput.name = 'finalscore';
   scoreInput.value = finalScore;
   document.querySelector('form').appendChild(scoreInput); */
   score.value = parseInt(finalScore);
   // Submit the form after validation
   document.querySelector('form').submit();
 });

  </script>
</body>

</html>
 -->
 
 
 <!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Registration Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/mdb-ui-kit@6.1.0/dist/css/mdb.min.css" rel="stylesheet">

    <style>
        @media (min-width: 1025px) {
            .h-custom {
                height: 100vh !important;
            }
        }
        .gradient-custom-2 {
            background: linear-gradient(to right, rgba(161, 196, 253, 1), rgba(194, 233, 251, 1));
        }
        .bg-indigo {
            background-color: #4835d4;
        }
		
        
    </style>
</head>
<body>
<form action="/jobs/jobapplied" method="post">
    <section class="h-100 h-custom gradient-custom-2">
        <div class="container py-5 h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12">
                    <div class="card card-registration card-registration-2" style="border-radius: 15px;">
                        <div class="card-body p-0">
                            <div class="row g-0">
                                <!-- Job Details Section -->
                                <div class="col-lg-6">
                                    <div class="p-5">
                                        <h3 class="fw-normal mb-5" style="color: #4835d4;">Job Details</h3>
                                        <div class="mb-4 pb-2">
                                            <label>Job ID:</label>
                                            <input type="text" th:value="${job.id}" id="job_id" name="job_id" class="form-control" readonly />
                                        </div>
                                        <div class="mb-4 pb-2">
                                            <label>Job Profile:</label>
                                            <input type="text" th:value="${job.profile}" id="job_profile" name="job_profile" class="form-control" readonly />
                                        </div>
                                        <div class="mb-4 pb-2">
                                            <label>Job Description:</label>
                                            <textarea th:text="${job.description}" class="form-control" readonly></textarea>
                                        </div>
                                        <div class="mb-4 pb-2">
                                            <label>Required Skills:</label>
                                            <ul>
                                                <li th:each="tech : ${job.techsList}" th:text="${tech}"></li>
                                            </ul>
                                        </div>
                                        <div class="mb-4 pb-2">
                                            <label>Experience (in years):</label>
                                            <span th:text="${job.experience}" id="jobexp" name="jobexp" class="form-control" readonly ></span>
                                        </div>
                                         <input type="hidden" th:value="${job.techs}" id="techs" name="techs" class="form-control" readonly />
                                    </div>
                                </div>

                                <!-- Candidate Details Section -->
                                <div class="col-lg-6 bg-indigo text-white">
                                    <div class="p-5">
                                        <h3 class="fw-normal mb-5">Candidate Details</h3>
                                        <div class="row mb-4 pb-2">
                                            <div class="col-md-6">
                                                <label>CANDIDATE ID:</label>
                                                <input type="text" th:value="${user.id}" name="user_id" id="user_id" class="form-control" readonly />
                                            </div>
                                            <div class="col-md-6">
                                                <label>CANDIDATE NAME:</label>
                                                <input type="text" th:value="${user.name}" name="user_name" id="user_name" class="form-control" readonly />
                                            </div>
                                        </div>
                                        <div class="row mb-4 pb-2">
                                            <div class="col-md-6">
                                                <label>CANDIDATE EMAIL:</label>
                                                <input type="text" th:value="${user.email}" name="user_email" id="user_email" class="form-control" readonly />
                                            </div>
                                            <div class="col-md-6">
                                                <label>CANDIDATE PHONE:</label>
                                                <input type="text" th:value="${user.phone}" name="user_phone" id="user_phone" class="form-control" readonly />
                                            </div>
                                        </div>
                                        
                                        <!-- Qualification Details Section -->
                                        <h4 class="fw-normal mb-5">Qualification Details</h4>
                                        <div class="row mb-4 pb-2">
                                            <div class="col-md-6">
                                                <label for="x_percentage">X Percentage:</label>
                                                <input type="number" id="x_percentage" name="x_percent" class="form-control" min="1" max="100" required />
                                            </div>
                                            <div class="col-md-6">
                                                <label for="xii_percentage">XII Percentage:</label>
                                                <input type="number" id="xii_percentage" name="xii_percent" class="form-control" min="1" max="100" required />
                                            </div>
                                        </div>
                                        <div class="row mb-4 pb-2">
                                            <div class="col-md-6">
                                                <label for="ug_percentage">UG Percentage:</label>
                                                <input type="number" id="ug_percentage" name="ug_percent" class="form-control" min="1" max="100" required />
                                            </div>
                                            <div class="col-md-6">
                                                <label for="experience">Experience (in years):</label>
                                                <input type="number" id="experience" name="exp" class="form-control" min="0" max="50" required />
                                            </div>
                                        </div>

                                        <!-- Skills Selection Section -->
                                        <h4 class="fw-normal mb-5">Skills Selection</h4>
                                        <div class="mb-4 pb-2">
                                            <label for="skills-input">Skills:</label>
                                            <input type="text" id="skills-input" list="skills-list" placeholder="Type to select a skill" class="form-control" />
                                            <datalist id="skills-list">
                                                <option value="java">JAVA</option>
                                                <option value="JEE">JEE</option>
                                                <option value="Spring">SPRING</option>
                                                <option value="SpringBoot"></option>
                                                <option value="Microservices"></option>
                                                <option value="Threads"></option>
                                                <option value="AWS"></option>
                                                <option value="Azure"></option>
                                                <option value="DevOps"></option>
                                                <option value="Blockchain"></option>
                                                <option value="Android"></option>
                                                <option value="Data Science"></option>
                                                <option value="C"></option>
                                                <option value="C++"></option>
                                                <option value="Kubernetes"></option>
                                                <option value="Hadoop"></option>
                                                <option value="Big Data"></option>
                                                <option value="Python"></option>
                                                <option value="NumPy"></option>
                                                <option value="Pandas"></option>
                                                <option value="Matplotlib"></option>
                                                <option value="Libraries"></option>
                                                <option value="Design Patterns"></option>
                                                <option value="Cloud"></option>
                                            </datalist>
                                             <input type="hidden" id="selected-skills-input" name="selected_skills" />
											      <input type="hidden" id="final_score" name="final_score" />
											      <input type="hidden" id="result" name="result" value="pending" />
											      <div id="selected-skills" ></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center mb-4">
                        <button type="submit" class="btn btn-light btn-lg" >Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    </form>
  <script>
  const jobExperience = parseFloat(document.getElementById('jobexp')?.textContent.trim() || "0");
  const jobSkills = document.getElementById('techs').value.split(',').map(skill => skill.trim()) || [];
  //.textContent.split(',').map(skill => skill.trim()) || [];
  console.log(jobSkills);
  const skillsInputField = document.getElementById('skills-input');
  const selectedSkillsContainer = document.getElementById('selected-skills');
  const submitButton = document.querySelector('button[type="submit"]');
  const score=document.getElementById('final_score');
  const selectedSkills = new Set();

  // Add skill to the list
// Add skill to the list
skillsInputField.addEventListener('change', () => {
  const skill = skillsInputField.value.trim();
  if (skill && !selectedSkills.has(skill)) {
    selectedSkills.add(skill);
    displaySelectedSkills();
    skillsInputField.value = ''; // Clear the input field
  }
});

// Display selected skills dynamically
function displaySelectedSkills() {
  selectedSkillsContainer.innerHTML = ''; // Clear existing skills
  const skillsArray = Array.from(selectedSkills); // Convert Set to Array
  document.getElementById('selected-skills-input').value = skillsArray.join(','); // Update hidden input

  skillsArray.forEach(skill => {
    const skillDiv = document.createElement('div');
    skillDiv.className = 'skill-item';
    skillDiv.textContent = skill;

    const removeButton = document.createElement('span');
    removeButton.className = 'remove-skill';
    removeButton.textContent = 'Ã—';
    removeButton.addEventListener('click', () => {
      selectedSkills.delete(skill); // Remove from the set
      displaySelectedSkills(); // Update display
    });

    skillDiv.appendChild(removeButton);
    selectedSkillsContainer.appendChild(skillDiv); // Append skill to container
  });
}




 
//Add validation and final score calculation on submit
 submitButton.addEventListener('click', (e) => {
   e.preventDefault(); // Prevent form from submitting by default

   // Validate experience
   const userExperience = parseFloat(document.getElementById('experience').value);
   if (userExperience < jobExperience) {
     alert(`Your experience (${userExperience} years) must be at least ${jobExperience} years.`);
     return; // Exit if experience is invalid
   }

   // Validate percentages
   const xPercent = parseFloat(document.getElementById('x_percentage').value);
   const xiiPercent = parseFloat(document.getElementById('xii_percentage').value);
   const ugPercent = parseFloat(document.getElementById('ug_percentage').value);

   if (
     xPercent > 100 || xiiPercent > 100 || ugPercent > 100 ||
     xPercent < 0 || xiiPercent < 0 || ugPercent < 0 ||
     isNaN(xPercent) || isNaN(xiiPercent) || isNaN(ugPercent)
   ) {
     alert('Please ensure percentages are between 0 and 100.');
     return; // Exit if percentages are invalid
   }

   // Check if all percentage fields are filled
   if (isNaN(xPercent) || isNaN(xiiPercent) || isNaN(ugPercent) || xPercent === '' || xiiPercent === '' || ugPercent === '') {
     alert('Please fill in all percentage fields.');
     return; // Exit if any of the fields are empty
   }

   // Calculate average percentage score
   const averagePercentageScore = ((xPercent + xiiPercent + ugPercent) / 3).toFixed(2);

   // Validate and calculate skills match score
   let matchedSkillsCount = 0;
   selectedSkills.forEach(skill => {
     if (jobSkills.includes(skill.toLowerCase().toString())) {
       matchedSkillsCount++;
     }
   });
   const skillsMatchScore = ((matchedSkillsCount / jobSkills.length) * 100).toFixed(2);

   // Calculate final score by averaging percentage and skills scores
   const finalScore = ((parseFloat(averagePercentageScore) + parseFloat(skillsMatchScore)) / 2).toFixed(2);

   // Display the final scores in an alert
   alert(`
     Validation successful!
     - Average Percentage Score: ${averagePercentageScore}%
     - Skills Match Score: ${skillsMatchScore}%
     - Final Combined Score: ${finalScore}%
   `);

   // Store the final score in a hidden input field
   /* const scoreInput = document.createElement('input');
   scoreInput.type = 'hidden';
   scoreInput.name = 'finalscore';
   scoreInput.value = finalScore;
   document.querySelector('form').appendChild(scoreInput); */
   score.value = parseInt(finalScore);
   // Submit the form after validation
   document.querySelector('form').submit();
 });

  </script>
</body>
</html>
 